@using System
@using Sandbox.UI
@using Observation

@namespace Observation.UI
@attribute [Hud( true )]
@inherits Panel

<root>
	@foreach ( var anomalyType in Enum.GetValues<Anomaly.AnomalyType>() )
	{
		<button onclick="@( () => Report( anomalyType ) )">@anomalyType.GetTitle()</button>
	}
</root>

@code {
	#nullable enable

	public Action<Anomaly.AnomalyType>? OnReport { get; set; }

	public void Report( Anomaly.AnomalyType type )
	{
		if ( type == Anomaly.AnomalyType.CameraMalfunction )
		{
			SetCameraList( type );
		}
		
		OnReport?.Invoke( type );

		this.Hide();
	}

	public static void SetCameraList( Anomaly.AnomalyType anomalyType )
	{
		var cameraList = Hud.GetElement<RoomList>();
		if ( !cameraList.IsValid() )
			return;

		cameraList.AnomalyType = anomalyType;
	}
}
